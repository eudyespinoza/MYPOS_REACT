{% load static %}
<div id="paymentSimulatorModal" class="modal fade payment-simulator-modal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-xxl modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content shadow-lg border-0">
      <div class="modal-header bg-dark text-white">
        <h5 class="modal-title">Simulador de Pagos</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body p-3">
        <h1 class="h4 mb-3">Simulador de Pagos</h1>

        <div class="row g-3 mb-3 align-items-end">
          <div class="col-md-3">
            <label class="form-label mb-1">Importe del carrito</label>
            <div id="cartAmountLabel" class="fw-semibold" style="font-size:1.5rem;">$ 0,00</div>
          </div>
          <div class="col-md-4 d-flex flex-column gap-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="onlyCards">
              <label class="form-check-label" for="onlyCards">Solo tarjetas</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="tasa1">
              <label class="form-check-label" for="tasa1">Tasa 1</label>
            </div>
          </div>
          <div class="col-md-5 d-flex justify-content-end align-items-end flex-wrap gap-3" style="display:none !important" aria-hidden="true">
            <div class="form-check">
              <label class="form-check-label">Distribución:&nbsp;</label>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="distMode" id="distMonto" value="monto" checked>
                <label class="form-check-label" for="distMonto">Monto</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="distMode" id="distPct" value="pct">
                <label class="form-check-label" for="distPct">%</label>
              </div>
            </div>
            <button id="simulateBtn" class="btn btn-primary">Simular</button>
          </div>
        </div>

        <h5>Lineas de pago</h5>
        <table class="table table-sm" id="linesTable">
          <thead>
            <tr>
              <th>Importe</th>
              <th>Metodo</th>
              <th>Marca</th>
              <th>Banco</th>
              <th>Adquiriente</th>
              <th>Plan</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="linesBody"></tbody>
          <tfoot>
            <tr>
              <td colspan="7"><button id="addLine" class="btn btn-outline-secondary btn-sm">Agregar linea</button></td>
            </tr>
          </tfoot>
        </table>

        <hr>
        <h5>Resumen</h5>
        <div class="row g-3">
          <div class="col-md-2">
            <div class="form-text">Subtotal lineas</div>
            <div id="sumLines" class="fs-5">0,00</div>
          </div>
          <div class="col-md-2">
            <div class="form-text">Descuentos</div>
            <div id="discounts" class="fs-5">0,00</div>
          </div>
          <div class="col-md-2">
            <div class="form-text">Base imponible</div>
            <div id="base" class="fs-5">0,00</div>
          </div>
          <div class="col-md-2">
            <div class="form-text">IVA</div>
            <div id="vat" class="fs-5">0,00</div>
          </div>
          <div class="col-md-2">
            <div class="form-text">Intereses</div>
            <div id="interests" class="fs-5">0,00</div>
          </div>
          <div class="col-md-2">
            <div class="form-text">Total</div>
            <div id="total" class="fs-4 fw-bold">0,00</div>
          </div>
          <div class="col-12 d-flex flex-column flex-md-row align-items-start align-items-md-center gap-2">
            <span id="mismatch" class="badge bg-warning text-dark d-none">Las lineas no igualan el total del carrito</span>
            <div class="ms-md-auto d-flex align-items-center gap-2">
              <button id="confirmBtn" class="btn btn-success btn-sm" disabled>Confirmar</button>
              <span id="confirmStatus" class="small text-success d-none"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="{% static 'js/payment_simulator_inline.js' %}"></script>
